<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NBA Matches &mdash; Matheus Siniscarchio 1 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Sepsis Detection" href="../Sepsis%20Detection/Final_Sepse.html" />
    <link rel="prev" title="Car Price" href="../Car_Price/Car_Price.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Matheus Siniscarchio
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Aprendizado Máquina</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Car_Price/Car_Price.html">Car Price</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">NBA Matches</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Objetivo">Objetivo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Entendendo-os-dados">Entendendo os dados</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Porcentagem-de-dados-jogos-vencidos-e-jogos-perdidos">Porcentagem de dados jogos vencidos e jogos perdidos</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Pre-processamento">Pre-processamento</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Tratando-as-datas">Tratando as datas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Criacao-de-algumas-features-com-data">Criacao de algumas features com data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Análise-exploratória-(Variáveis-de-datas)">Análise exploratória (Variáveis de datas)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Gráfico-de-barras-(variáveis-de-datas)">Gráfico de barras (variáveis de datas)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Criacao-da-feature-season-(estacao-do-ano:-Primavera,-verão,-outono-e-inverno)">Criacao da feature season (estacao do ano: Primavera, verão, outono e inverno)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Retirando-a-coluna-Game">Retirando a coluna Game</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Retirando-a-coluna-Date">Retirando a coluna Date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Transformando-os-dados-do-tipo-object-‘O’-para-tipo-int">Transformando os dados do tipo object ‘O’ para tipo int</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Feature-Selection">Feature Selection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Feature-Importance-(Random-Forest)">Feature Importance (Random Forest)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Selecionando-k-colunas-por-ordem-de-importancia">Selecionando k colunas por ordem de importancia</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#EDA">EDA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Correlation-Heatmap">Correlation Heatmap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Padronização-e-Train-test-split">Padronização e Train test split</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Naive-Bayes">Naive Bayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SVM">SVM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Submetendo-NB">Submetendo NB</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Submetendo-SVM">Submetendo SVM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Sepsis%20Detection/Final_Sepse.html">Sepsis Detection</a></li>
</ul>
<p class="caption"><span class="caption-text">Finanças Quantitativas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Finances/MA%20strategy%20e%20backtest.html">Backtest &amp; MA Strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Finances/MA%20strategy%20e%20backtest.html#Moving-average-(MA)-cross-over-strategy">Moving average (MA) cross-over strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Finances/MA%20strategy%20e%20backtest.html#Backtest">Backtest</a></li>
</ul>
<p class="caption"><span class="caption-text">Estudo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../regressao_simples.html">Modelo de regressão linear simples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Matheus Siniscarchio</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>NBA Matches</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Jupyter/NBA Matches/Final_Games.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="NBA-Matches">
<h1>NBA Matches<a class="headerlink" href="#NBA-Matches" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Objetivo">
<h2>Objetivo<a class="headerlink" href="#Objetivo" title="Permalink to this headline">¶</a></h2>
<p>Considerando o crescente uso de ciência dos dados no mercardo esportivo e de especulação, nesta semana vocês farão parte de uma startup que quer quebrar os sites de apostas da NBA!</p>
<p>O mercado online de apostas foi avaliado em US$85.047 no ano de 2019 e pode ter um crescimento ainda maior nos próximos anos levando em consideração a posição favorável de alguns governos com a legalização das plataformas e pagamento de impostos. [1]</p>
<p>Com isso, a startup de vocês, RodaRodaBet, após um estudo inicial sobre o mercado de apostas americano e dos dados disponíveis online sobre a NBA [2], está buscando a construção de um modelo que possa indicar se os times da casa irão ganhar ou perder em cada rodada da liga.</p>
<p>Neste desafio, vocês irão utilizar dados raspados da NBA &amp; ABA League Index, que contém informações sobre os times que jogam em cada rodada da NBA, para prever se determinado time da casa vai ganhar ou perder (Win or Lose).</p>
<p>References:</p>
<p>1 - <a class="reference external" href="https://www.globenewswire.com/news-release/2020/08/31/2086041/0/en/Global-Sports-Betting-Market-Worth-85-Billion-in-2019-Industry-Assessment-and-Forecasts-Throughout-2020-2025.html">https://www.globenewswire.com/news-release/2020/08/31/2086041/0/en/Global-Sports-Betting-Market-Worth-85-Billion-in-2019-Industry-Assessment-and-Forecasts-Throughout-2020-2025.html</a></p>
<p>2 - <a class="reference external" href="https://towardsdatascience.com/predicting-the-2020-nba-playoffs-bracket-with-machine-learning-2030f80fa62c">https://towardsdatascience.com/predicting-the-2020-nba-playoffs-bracket-with-machine-learning-2030f80fa62c</a></p>
<p>3 - <a class="reference external" href="https://www.basketball-reference.com/leagues/">https://www.basketball-reference.com/leagues/</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_test</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;test_without_label.csv&quot;</span><span class="p">)</span>
<span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;train_full.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Entendendo-os-dados">
<h2>Entendendo os dados<a class="headerlink" href="#Entendendo-os-dados" title="Permalink to this headline">¶</a></h2>
<p>Pelo fato das variáveis serem as estatísticas dos jogos e por termos bastantes variáveis nesse sentido, optamos por não criar novas variáveis a partir delas. Decidimos investir na variável data. Observamos que a variável dia do ano foi bastante importante para os modelos testados e a partir disso, criamos outras variações, como dias da semana, dias do mês, entre outros.</p>
<div class="section" id="Porcentagem-de-dados-jogos-vencidos-e-jogos-perdidos">
<h3>Porcentagem de dados jogos vencidos e jogos perdidos<a class="headerlink" href="#Porcentagem-de-dados-jogos-vencidos-e-jogos-perdidos" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># remove espaço nos nomes das colunas</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">df_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_test</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_train</span><span class="o">.</span><span class="n">WinOrLose</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
L    654
W    352
Name: WinOrLose, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">WinOrLose</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">df_train</span><span class="o">.</span><span class="n">WinOrLose</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#frequencia absoluta</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequencia absoluta de Vitorias e derrotas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_10_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_10_0.png" />
</div>
</div>
<p>Temos uma grande maioria de jogos perdidos, portanto eh necessario uma analise estratificada quando for treinar os modelos</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Game</th>
      <th>Data</th>
      <th>H_Team</th>
      <th>H_Wins</th>
      <th>H_Loss</th>
      <th>H_W/D %</th>
      <th>H_SRS</th>
      <th>H_Games</th>
      <th>H_TotalPoints</th>
      <th>H_AvgPointsPerGame</th>
      <th>...</th>
      <th>A_TS%</th>
      <th>A_eFG%</th>
      <th>A_TOV%</th>
      <th>A_ORB%</th>
      <th>A_FT/FGA</th>
      <th>A_OeFG%</th>
      <th>A_OTOV%</th>
      <th>A_DRB%</th>
      <th>A_OFT/FGA</th>
      <th>WinOrLose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Thu, June 8</td>
      <td>Miami Heat</td>
      <td>52</td>
      <td>30</td>
      <td>0.634</td>
      <td>3.59</td>
      <td>82</td>
      <td>8191</td>
      <td>99.9</td>
      <td>...</td>
      <td>0.550</td>
      <td>0.495</td>
      <td>13.1</td>
      <td>31.8</td>
      <td>0.285</td>
      <td>0.475</td>
      <td>13.7</td>
      <td>72.2</td>
      <td>0.257</td>
      <td>L</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Sun, June 11</td>
      <td>Miami Heat</td>
      <td>52</td>
      <td>30</td>
      <td>0.634</td>
      <td>3.59</td>
      <td>82</td>
      <td>8191</td>
      <td>99.9</td>
      <td>...</td>
      <td>0.550</td>
      <td>0.495</td>
      <td>13.1</td>
      <td>31.8</td>
      <td>0.285</td>
      <td>0.475</td>
      <td>13.7</td>
      <td>72.2</td>
      <td>0.257</td>
      <td>L</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Tue, June 13</td>
      <td>Dallas Mavericks</td>
      <td>60</td>
      <td>22</td>
      <td>0.732</td>
      <td>5.96</td>
      <td>82</td>
      <td>8130</td>
      <td>99.1</td>
      <td>...</td>
      <td>0.556</td>
      <td>0.517</td>
      <td>13.9</td>
      <td>26.7</td>
      <td>0.254</td>
      <td>0.477</td>
      <td>12.4</td>
      <td>76.4</td>
      <td>0.251</td>
      <td>L</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Thu, June 15</td>
      <td>Dallas Mavericks</td>
      <td>60</td>
      <td>22</td>
      <td>0.732</td>
      <td>5.96</td>
      <td>82</td>
      <td>8130</td>
      <td>99.1</td>
      <td>...</td>
      <td>0.556</td>
      <td>0.517</td>
      <td>13.9</td>
      <td>26.7</td>
      <td>0.254</td>
      <td>0.477</td>
      <td>12.4</td>
      <td>76.4</td>
      <td>0.251</td>
      <td>L</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Sun, June 18</td>
      <td>Dallas Mavericks</td>
      <td>60</td>
      <td>22</td>
      <td>0.732</td>
      <td>5.96</td>
      <td>82</td>
      <td>8130</td>
      <td>99.1</td>
      <td>...</td>
      <td>0.556</td>
      <td>0.517</td>
      <td>13.9</td>
      <td>26.7</td>
      <td>0.254</td>
      <td>0.477</td>
      <td>12.4</td>
      <td>76.4</td>
      <td>0.251</td>
      <td>L</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 135 columns</p>
</div></div>
</div>
</div>
</div>
<div class="section" id="Pre-processamento">
<h2>Pre-processamento<a class="headerlink" href="#Pre-processamento" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Tratando-as-datas">
<h3>Tratando as datas<a class="headerlink" href="#Tratando-as-datas" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">treino</span> <span class="o">=</span> <span class="n">df_train</span>
<span class="n">teste</span>  <span class="o">=</span> <span class="n">df_test</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Na base de teste</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">teste</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">%a</span><span class="s1">, %B </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>

<span class="c1">#base de treino</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">treino</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">%a</span><span class="s1">, %B </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Data&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Users\msini\Anaconda3\lib\site-packages\pandas\core\indexing.py:1637: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self._setitem_single_block(indexer, value, name)
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Criacao-de-algumas-features-com-data">
<h2>Criacao de algumas features com data<a class="headerlink" href="#Criacao-de-algumas-features-com-data" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Dia&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
<span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Dia&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treino</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>

<span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Dia&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
<span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Dia&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treino</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>

<span class="n">teste</span><span class="p">[</span><span class="s1">&#39;weekday&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span>
<span class="n">treino</span><span class="p">[</span><span class="s1">&#39;weekday&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treino</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span>

<span class="n">teste</span><span class="p">[</span><span class="s1">&#39;weekofyear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekofyear</span>
<span class="n">treino</span><span class="p">[</span><span class="s1">&#39;weekofyear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treino</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekofyear</span>

<span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Dia do Ano&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span>
<span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Dia do Ano&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treino</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-9-c7af2d33b494&gt;:10: FutureWarning: Series.dt.weekofyear and Series.dt.week have been deprecated.  Please use Series.dt.isocalendar().week instead.
  teste[&#39;weekofyear&#39;] = teste.Data.dt.weekofyear
&lt;ipython-input-9-c7af2d33b494&gt;:11: FutureWarning: Series.dt.weekofyear and Series.dt.week have been deprecated.  Please use Series.dt.isocalendar().week instead.
  treino[&#39;weekofyear&#39;] = treino.Data.dt.weekofyear
</pre></div></div>
</div>
<div class="section" id="Análise-exploratória-(Variáveis-de-datas)">
<h3>Análise exploratória (Variáveis de datas)<a class="headerlink" href="#Análise-exploratória-(Variáveis-de-datas)" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vars_dias</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dia&#39;</span><span class="p">,</span> <span class="s1">&#39;weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;weekofyear&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vars_dias</span><span class="p">:</span>

  <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>

  <span class="n">x</span> <span class="o">=</span> <span class="n">treino</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="n">coluna</span> <span class="o">=</span> <span class="n">i</span>
  <span class="n">mu</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># mean of distribution</span>
  <span class="n">sigma</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># standard deviation of distribution</span>

  <span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_box</span><span class="p">,</span> <span class="n">ax_hist</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

  <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_box</span><span class="p">)</span>
  <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_hist</span><span class="p">)</span>

  <span class="n">ax_box</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
  <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_hist</span><span class="p">)</span>
  <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_box</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">ax_box</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Boxplot e Histograma de </span><span class="si">{}</span><span class="se">\n</span><span class="s1"> $\mu=</span><span class="si">{}</span><span class="s1">$, $\sigma=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coluna</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_20_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_20_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_20_1.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_20_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_20_2.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_20_2.png" />
</div>
</div>
<p>Weekofyear e Dia do ano possuem um formato de distribuição próximo.</p>
</div>
<div class="section" id="Gráfico-de-barras-(variáveis-de-datas)">
<h3>Gráfico de barras (variáveis de datas)<a class="headerlink" href="#Gráfico-de-barras-(variáveis-de-datas)" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visu</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;weekday&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">treino</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">margin_titles</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">visu</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticklabels</span><span class="o">=</span><span class="p">[])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_23_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_23_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visu</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;weekofyear&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">treino</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">margin_titles</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">visu</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticklabels</span><span class="o">=</span><span class="p">[])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_24_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_24_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visu</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Dia do Ano&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">treino</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">margin_titles</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">visu</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticklabels</span><span class="o">=</span><span class="p">[])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_25_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_25_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">visu</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Dia&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">treino</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">margin_titles</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">visu</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticklabels</span><span class="o">=</span><span class="p">[])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_26_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_26_0.png" />
</div>
</div>
</div>
<div class="section" id="Criacao-da-feature-season-(estacao-do-ano:-Primavera,-verão,-outono-e-inverno)">
<h3>Criacao da feature season (estacao do ano: Primavera, verão, outono e inverno)<a class="headerlink" href="#Criacao-da-feature-season-(estacao-do-ano:-Primavera,-verão,-outono-e-inverno)" title="Permalink to this headline">¶</a></h3>
<p>lembrar que nos EUA as estacoes do ano sao diferentes</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Season&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">%</span><span class="k">12</span> // 3 + 1
<span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Season&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treino</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">%</span><span class="k">12</span> // 3 + 1
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="n">teste_total</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2    77
3    47
4    41
Name: Season, dtype: int64
2    924
3     82
Name: Season, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">teste</span><span class="p">[</span><span class="s1">&#39;Season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#frequencia absoluta</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequencia absoluta de Season dataframe de teste&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">treino</span><span class="p">[</span><span class="s1">&#39;Season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#frequencia absoluta</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequencia absoluta de Season dataframe de treino&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_31_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_31_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_31_1.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_31_1.png" />
</div>
</div>
<p>Note que os jogos acontecem exclusivamente nas seasons 2, 3 e 4 e veja que no treino temos quase que exclusivamente os jogos acontecendo na season 2, indicando que essa variável talvez não seja muito interessantes para os modelos.</p>
</div>
<div class="section" id="Retirando-a-coluna-Game">
<h3>Retirando a coluna Game<a class="headerlink" href="#Retirando-a-coluna-Game" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#teste</span>
<span class="n">Id</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">Game</span> <span class="c1">#sera utilizado para prever depois</span>
<span class="n">teste</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1">#treino</span>
<span class="n">treino</span> <span class="o">=</span> <span class="n">treino</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Retirando-a-coluna-Date">
<h3>Retirando a coluna Date<a class="headerlink" href="#Retirando-a-coluna-Date" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">teste</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">treino</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Transformando-os-dados-do-tipo-object-‘O’-para-tipo-int">
<h3>Transformando os dados do tipo object ‘O’ para tipo int<a class="headerlink" href="#Transformando-os-dados-do-tipo-object-‘O’-para-tipo-int" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="n">le</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()</span>
<span class="c1">#base de treino</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">treino</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span>
  <span class="k">if</span> <span class="n">treino</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
    <span class="n">treino</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">treino</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>

<span class="c1">#Na base de test</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">teste</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span>
  <span class="k">if</span> <span class="n">teste</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
    <span class="n">teste</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">teste</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Feature-Selection">
<h2>Feature Selection<a class="headerlink" href="#Feature-Selection" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Feature-Importance-(Random-Forest)">
<h3>Feature Importance (Random Forest)<a class="headerlink" href="#Feature-Importance-(Random-Forest)" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Divide the features into Independent and Dependent Variable</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">treino</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;WinOrLose&#39;</span> <span class="p">,</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_completo</span> <span class="o">=</span> <span class="n">X</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">treino</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span>
<span class="n">y_completo</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">colunas</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">scaler_train</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="c1">#scaler_train = MinMaxScaler()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler_train</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1">#Nao precisa padronizar o teste pq estamos apenas vendo as features de importancia</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">model</span>  <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RandomForestClassifier()
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">plot_feature_importance</span><span class="p">(</span><span class="n">importance</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">model_type</span><span class="p">):</span>

    <span class="c1">#Create arrays from feature importance and feature names</span>
    <span class="n">feature_importance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">importance</span><span class="p">)</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

    <span class="c1">#Create a DataFrame using a Dictionary</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;feature_names&#39;</span><span class="p">:</span><span class="n">feature_names</span><span class="p">,</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">:</span><span class="n">feature_importance</span><span class="p">}</span>
    <span class="n">fi_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1">#Sort the DataFrame in order decreasing feature importance</span>
    <span class="n">fi_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">#Define size of bar plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>
    <span class="c1">#Plot Searborn bar chart</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">fi_df</span><span class="p">[</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">fi_df</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">])</span>
    <span class="c1">#Add chart labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">model_type</span> <span class="o">+</span> <span class="s1">&#39;FEATURE IMPORTANCE&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;FEATURE IMPORTANCE&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;FEATURE NAMES&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plot_feature_importance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span><span class="n">colunas</span><span class="p">,</span><span class="s1">&#39;Random Forest &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_45_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_45_0.png" />
</div>
</div>
</div>
<div class="section" id="Selecionando-k-colunas-por-ordem-de-importancia">
<h3>Selecionando k colunas por ordem de importancia<a class="headerlink" href="#Selecionando-k-colunas-por-ordem-de-importancia" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>    <span class="c1">#Create arrays from feature importance and feature names</span>
    <span class="n">importance</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">colunas</span>

    <span class="n">feature_importance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">importance</span><span class="p">)</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

    <span class="c1">#Create a DataFrame using a Dictionary</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;feature_names&#39;</span><span class="p">:</span><span class="n">feature_names</span><span class="p">,</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">:</span><span class="n">feature_importance</span><span class="p">}</span>
    <span class="n">fi_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1">#Sort the DataFrame in order decreasing feature importance</span>
    <span class="n">fi_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feature_importance&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#Resetando os index para poder selecionar as colunas desejadas</span>
    <span class="n">fi_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#Selecionando o numero de colunas que deseja, por ordem de importancia</span>
    <span class="n">select_colunas</span> <span class="o">=</span> <span class="n">fi_df</span><span class="o">.</span><span class="n">feature_names</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">list</span><span class="p">(</span><span class="n">select_colunas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Dia&#39;,
 &#39;Dia do Ano&#39;,
 &#39;weekday&#39;,
 &#39;weekofyear&#39;,
 &#39;A_MOV&#39;,
 &#39;A_SRS&#39;,
 &#39;H_Wins&#39;,
 &#39;A_W/D %&#39;,
 &#39;A_FG%&#39;,
 &#39;H_Loss&#39;,
 &#39;H_eFG%&#39;,
 &#39;H_TS%&#39;,
 &#39;H_W/D %&#39;,
 &#39;A_Loss&#39;]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">treino_completo</span> <span class="o">=</span> <span class="n">treino</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">teste_completo</span> <span class="o">=</span> <span class="n">teste</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">treino</span> <span class="o">=</span> <span class="n">treino</span><span class="p">[</span><span class="n">select_colunas</span><span class="p">]</span>

<span class="n">teste</span> <span class="o">=</span> <span class="n">teste</span><span class="p">[</span><span class="n">select_colunas</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">treino</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dia</th>
      <th>Dia do Ano</th>
      <th>weekday</th>
      <th>weekofyear</th>
      <th>A_MOV</th>
      <th>A_SRS</th>
      <th>H_Wins</th>
      <th>A_W/D %</th>
      <th>A_FG%</th>
      <th>H_Loss</th>
      <th>H_eFG%</th>
      <th>H_TS%</th>
      <th>H_W/D %</th>
      <th>A_Loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>159</td>
      <td>4</td>
      <td>23</td>
      <td>6.07</td>
      <td>5.96</td>
      <td>52</td>
      <td>0.732</td>
      <td>0.462</td>
      <td>30</td>
      <td>0.517</td>
      <td>0.556</td>
      <td>0.634</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>162</td>
      <td>0</td>
      <td>24</td>
      <td>6.07</td>
      <td>5.96</td>
      <td>52</td>
      <td>0.732</td>
      <td>0.462</td>
      <td>30</td>
      <td>0.517</td>
      <td>0.556</td>
      <td>0.634</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13</td>
      <td>164</td>
      <td>2</td>
      <td>24</td>
      <td>3.87</td>
      <td>3.59</td>
      <td>60</td>
      <td>0.634</td>
      <td>0.478</td>
      <td>22</td>
      <td>0.495</td>
      <td>0.550</td>
      <td>0.732</td>
      <td>30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>166</td>
      <td>4</td>
      <td>24</td>
      <td>3.87</td>
      <td>3.59</td>
      <td>60</td>
      <td>0.634</td>
      <td>0.478</td>
      <td>22</td>
      <td>0.495</td>
      <td>0.550</td>
      <td>0.732</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18</td>
      <td>169</td>
      <td>0</td>
      <td>25</td>
      <td>3.87</td>
      <td>3.59</td>
      <td>60</td>
      <td>0.634</td>
      <td>0.478</td>
      <td>22</td>
      <td>0.495</td>
      <td>0.550</td>
      <td>0.732</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>
<div class="section" id="EDA">
<h2>EDA<a class="headerlink" href="#EDA" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Correlation-Heatmap">
<h3>Correlation Heatmap<a class="headerlink" href="#Correlation-Heatmap" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># define the mask to set the values in the upper triangle to True</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">treino</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">))</span>
<span class="n">heatmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">treino</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;BrBG&#39;</span><span class="p">)</span>
<span class="n">heatmap</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Correlation Heatmap&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span><span class="mi">18</span><span class="p">},</span> <span class="n">pad</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-30-4aa79b6928d7&gt;:3: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  mask = np.triu(np.ones_like(treino.corr(), dtype=np.bool))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_53_1.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_53_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">treino</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1006, 14)
(1006,)
</pre></div></div>
</div>
<p>Através das 14 primeiras variáveis selecionadas (apenas com a variável dia do ano, sem as outras derivações da Data), utilizamos o método de seleção forward para encontrar o melhor subconjunto de forma a obtermos o melhor resultado, considerando a métrica curva roc. Após observarmos qual foi o melhor subconjunto, fomos eliminando aquelas variáveis que estavam correlacionadas com alguma outra variável. Fizemos isso considerando apenas a variável Dia do Ano na hora de rodar o modelo randon forest
(eliminando as outras variações da variável data) e obtivemos como melhores características, através do modelo Naive Bayes, as seguintes variáveis: ‘Dia do Ano’, ‘A_W/D %’, ‘A_FG%’, ‘H_MOV’, ‘H_eFG%’, ‘A_3P%’, ‘A_FT%’. Resultando no Score do Kaggle 0.727</p>
<p>Da mesma forma, fizemos o mesmo procedimento testando as outras variações das variáveis a partir da Data, eliminando a variável Dia do Ano, e obtivemos como melhores variáveis para o modelo de Naive Bayes: ‘Dia’, ‘weekday’, ‘weekofyear’, ‘H_eFG%’,‘A_W/D %’, ‘A_SRS’. E essas variáveis resultaram no melhor score do Kaggle: 0.729</p>
<p>Será reproduzido os resultados para a melhor acurácia que obtivemos no teste e que resultou na melhor classificação do kaggle.</p>
</div>
</div>
<div class="section" id="Padronização-e-Train-test-split">
<h2>Padronização e Train test split<a class="headerlink" href="#Padronização-e-Train-test-split" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#As 14 melhores variáveis escolhidas pelo modelo random forest sem a variável dia do Ano</span>
<span class="c1">#col = [&#39;Dia&#39;, &#39;weekday&#39;, &#39;weekofyear&#39;, &#39;A_Loss&#39;, &#39;H_eFG%&#39;, &#39;H_MOV&#39;, &#39;A_W/D %&#39;, &#39;H_SRS&#39;, &#39;A_MOV&#39;, &#39;A_Wins&#39;, &#39;A_SRS&#39;, &#39;H_TS%&#39;, &#39;H_W/D %&#39;, &#39;H_Loss&#39;]</span>

<span class="n">treino</span> <span class="o">=</span> <span class="n">X_completo</span><span class="p">[</span><span class="n">select_colunas</span><span class="p">]</span>
<span class="n">teste</span> <span class="o">=</span> <span class="n">teste_completo</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">scaler_train</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="c1">#scaler_train = MinMaxScaler()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler_train</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">treino</span><span class="p">)</span>

<span class="c1">#Vamos padronizar o teste tbm</span>
<span class="n">scaler_train</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="c1">#scaler_train = MinMaxScaler()</span>
<span class="n">teste</span> <span class="o">=</span> <span class="n">scaler_train</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">teste</span><span class="p">[</span><span class="n">select_colunas</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>


<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>

<span class="kn">from</span> <span class="nn">mlxtend.feature_selection</span> <span class="kn">import</span> <span class="n">SequentialFeatureSelector</span>

<span class="n">feature_selector</span> <span class="o">=</span> <span class="n">SequentialFeatureSelector</span><span class="p">(</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
           <span class="n">k_features</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
           <span class="n">forward</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
           <span class="n">verbose</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
           <span class="n">scoring</span> <span class="o">=</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
           <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># o subconjunto formado por 8 variáveis foi o escolhido: score: 0.615483</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">feature_selector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    5.3s remaining:    0.0s
[Parallel(n_jobs=1)]: Done  14 out of  14 | elapsed:   18.2s finished

[2021-10-09 17:31:45] Features: 1/14 -- score: 0.5970483694203371[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=1)]: Done  13 out of  13 | elapsed:   13.1s finished

[2021-10-09 17:31:58] Features: 2/14 -- score: 0.5919707650839727[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=1)]: Done  12 out of  12 | elapsed:   12.4s finished

[2021-10-09 17:32:10] Features: 3/14 -- score: 0.5784259204407453[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    1.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done  11 out of  11 | elapsed:   12.4s finished

[2021-10-09 17:32:23] Features: 4/14 -- score: 0.5912465566778236[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=1)]: Done  10 out of  10 | elapsed:   10.2s finished

[2021-10-09 17:32:33] Features: 5/14 -- score: 0.6063153490714137[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   9 out of   9 | elapsed:    9.1s finished

[2021-10-09 17:32:42] Features: 6/14 -- score: 0.6132538283818607[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   8 out of   8 | elapsed:    8.0s finished

[2021-10-09 17:32:51] Features: 7/14 -- score: 0.61611956103196[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   7 out of   7 | elapsed:    7.3s finished

[2021-10-09 17:32:58] Features: 8/14 -- score: 0.6224219513639999[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   6 out of   6 | elapsed:    6.1s finished

[2021-10-09 17:33:04] Features: 9/14 -- score: 0.6082610112259709[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    1.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   5 out of   5 | elapsed:    5.2s finished

[2021-10-09 17:33:09] Features: 10/14 -- score: 0.6064708539438998[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    1.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   4 out of   4 | elapsed:    4.4s finished

[2021-10-09 17:33:14] Features: 11/14 -- score: 0.5931933295814698[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    1.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   3 out of   3 | elapsed:    3.3s finished

[2021-10-09 17:33:17] Features: 12/14 -- score: 0.5899106957732295[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    1.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   2 out of   2 | elapsed:    2.2s finished

[2021-10-09 17:33:19] Features: 13/14 -- score: 0.5786436272622256[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    1.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    1.0s finished

[2021-10-09 17:33:21] Features: 14/14 -- score: 0.5741880424158052
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">features</span><span class="o">.</span><span class="n">subsets_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{1: {&#39;feature_idx&#39;: (7,),
  &#39;cv_scores&#39;: array([0.55236812, 0.67404698, 0.64054678, 0.5790335 , 0.53924647]),
  &#39;avg_score&#39;: 0.5970483694203371,
  &#39;feature_names&#39;: (&#39;7&#39;,)},
 2: {&#39;feature_idx&#39;: (7, 13),
  &#39;cv_scores&#39;: array([0.54331921, 0.65941471, 0.64372353, 0.57787832, 0.53551805]),
  &#39;avg_score&#39;: 0.5919707650839727,
  &#39;feature_names&#39;: (&#39;7&#39;, &#39;13&#39;)},
 3: {&#39;feature_idx&#39;: (1, 7, 13),
  &#39;cv_scores&#39;: array([0.57691567, 0.5883712 , 0.61676935, 0.60271467, 0.50735871]),
  &#39;avg_score&#39;: 0.5784259204407453,
  &#39;feature_names&#39;: (&#39;1&#39;, &#39;7&#39;, &#39;13&#39;)},
 4: {&#39;feature_idx&#39;: (1, 7, 10, 13),
  &#39;cv_scores&#39;: array([0.57653061, 0.55650751, 0.6380439 , 0.62726223, 0.55788854]),
  &#39;avg_score&#39;: 0.5912465566778236,
  &#39;feature_names&#39;: (&#39;1&#39;, &#39;7&#39;, &#39;10&#39;, &#39;13&#39;)},
 5: {&#39;feature_idx&#39;: (1, 2, 7, 10, 13),
  &#39;cv_scores&#39;: array([0.59655372, 0.53744705, 0.68569503, 0.61994609, 0.59193485]),
  &#39;avg_score&#39;: 0.6063153490714137,
  &#39;feature_names&#39;: (&#39;1&#39;, &#39;2&#39;, &#39;7&#39;, &#39;10&#39;, &#39;13&#39;)},
 6: {&#39;feature_idx&#39;: (1, 2, 3, 7, 10, 13),
  &#39;cv_scores&#39;: array([0.62216018, 0.54688102, 0.68800539, 0.63573354, 0.57348901]),
  &#39;avg_score&#39;: 0.6132538283818607,
  &#39;feature_names&#39;: (&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;7&#39;, &#39;10&#39;, &#39;13&#39;)},
 7: {&#39;feature_idx&#39;: (1, 2, 3, 5, 7, 10, 13),
  &#39;cv_scores&#39;: array([0.60117443, 0.59568733, 0.66316904, 0.6325568 , 0.5880102 ]),
  &#39;avg_score&#39;: 0.61611956103196,
  &#39;feature_names&#39;: (&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;5&#39;, &#39;7&#39;, &#39;10&#39;, &#39;13&#39;)},
 8: {&#39;feature_idx&#39;: (0, 1, 2, 3, 5, 7, 10, 13),
  &#39;cv_scores&#39;: array([0.60714286, 0.59145168, 0.66981132, 0.64882557, 0.59487834]),
  &#39;avg_score&#39;: 0.6224219513639999,
  &#39;feature_names&#39;: (&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;5&#39;, &#39;7&#39;, &#39;10&#39;, &#39;13&#39;)},
 9: {&#39;feature_idx&#39;: (0, 1, 2, 3, 4, 5, 7, 10, 13),
  &#39;cv_scores&#39;: array([0.5732576 , 0.61532538, 0.6413169 , 0.62427801, 0.58712716]),
  &#39;avg_score&#39;: 0.6082610112259709,
  &#39;feature_names&#39;: (&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;7&#39;, &#39;10&#39;, &#39;13&#39;)},
 10: {&#39;feature_idx&#39;: (0, 1, 2, 3, 4, 5, 7, 10, 11, 13),
  &#39;cv_scores&#39;: array([0.57142857, 0.60329226, 0.63274933, 0.64276088, 0.58212323]),
  &#39;avg_score&#39;: 0.6064708539438998,
  &#39;feature_names&#39;: (&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;7&#39;, &#39;10&#39;, &#39;11&#39;, &#39;13&#39;)},
 11: {&#39;feature_idx&#39;: (0, 1, 2, 3, 4, 5, 7, 8, 10, 11, 13),
  &#39;cv_scores&#39;: array([0.53475164, 0.60271467, 0.64767039, 0.61725067, 0.56357928]),
  &#39;avg_score&#39;: 0.5931933295814698,
  &#39;feature_names&#39;: (&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;7&#39;, &#39;8&#39;, &#39;10&#39;, &#39;11&#39;, &#39;13&#39;)},
 12: {&#39;feature_idx&#39;: (0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 13),
  &#39;cv_scores&#39;: array([0.55217559, 0.59520601, 0.63659992, 0.60964575, 0.55592622]),
  &#39;avg_score&#39;: 0.5899106957732295,
  &#39;feature_names&#39;: (&#39;0&#39;,
   &#39;1&#39;,
   &#39;2&#39;,
   &#39;3&#39;,
   &#39;4&#39;,
   &#39;5&#39;,
   &#39;7&#39;,
   &#39;8&#39;,
   &#39;9&#39;,
   &#39;10&#39;,
   &#39;11&#39;,
   &#39;13&#39;)},
 13: {&#39;feature_idx&#39;: (0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13),
  &#39;cv_scores&#39;: array([0.53696573, 0.59279938, 0.62283404, 0.60107817, 0.53954082]),
  &#39;avg_score&#39;: 0.5786436272622256,
  &#39;feature_names&#39;: (&#39;0&#39;,
   &#39;1&#39;,
   &#39;2&#39;,
   &#39;3&#39;,
   &#39;4&#39;,
   &#39;5&#39;,
   &#39;7&#39;,
   &#39;8&#39;,
   &#39;9&#39;,
   &#39;10&#39;,
   &#39;11&#39;,
   &#39;12&#39;,
   &#39;13&#39;)},
 14: {&#39;feature_idx&#39;: (0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13),
  &#39;cv_scores&#39;: array([0.52050443, 0.59279938, 0.62023489, 0.60512129, 0.53228022]),
  &#39;avg_score&#39;: 0.5741880424158052,
  &#39;feature_names&#39;: (&#39;0&#39;,
   &#39;1&#39;,
   &#39;2&#39;,
   &#39;3&#39;,
   &#39;4&#39;,
   &#39;5&#39;,
   &#39;6&#39;,
   &#39;7&#39;,
   &#39;8&#39;,
   &#39;9&#39;,
   &#39;10&#39;,
   &#39;11&#39;,
   &#39;12&#39;,
   &#39;13&#39;)}}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#O melhor subconjunto foi: [&#39;Dia&#39;, &#39;weekday&#39;, &#39;weekofyear&#39;, &#39;A_Loss&#39;, &#39;H_eFG%&#39;, &#39;A_W/D %&#39;, &#39;A_Wins&#39;, &#39;A_SRS&#39;]</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dia&#39;</span><span class="p">,</span> <span class="s1">&#39;weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;weekofyear&#39;</span><span class="p">,</span> <span class="s1">&#39;A_Loss&#39;</span><span class="p">,</span> <span class="s1">&#39;H_eFG%&#39;</span><span class="p">,</span> <span class="s1">&#39;A_W/D %&#39;</span><span class="p">,</span> <span class="s1">&#39;A_Wins&#39;</span><span class="p">,</span> <span class="s1">&#39;A_SRS&#39;</span><span class="p">]</span>
<span class="n">treino</span> <span class="o">=</span> <span class="n">X_completo</span>
<span class="n">treino</span> <span class="o">=</span> <span class="n">treino</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># define the mask to set the values in the upper triangle to True</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">treino</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">))</span>
<span class="n">heatmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">treino</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;BrBG&#39;</span><span class="p">)</span>
<span class="n">heatmap</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Correlation Heatmap&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span><span class="mi">18</span><span class="p">},</span> <span class="n">pad</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-40-4aa79b6928d7&gt;:3: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  mask = np.triu(np.ones_like(treino.corr(), dtype=np.bool))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_66_1.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_66_1.png" />
</div>
</div>
<p>Através das correlações, optamos por eliminar as variáveis ‘A_Loss’ e ‘A_Wins’</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dia&#39;</span><span class="p">,</span> <span class="s1">&#39;weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;weekofyear&#39;</span><span class="p">,</span> <span class="s1">&#39;H_eFG%&#39;</span><span class="p">,</span><span class="s1">&#39;A_W/D %&#39;</span><span class="p">,</span> <span class="s1">&#39;A_SRS&#39;</span><span class="p">]</span>
<span class="n">treino</span> <span class="o">=</span> <span class="n">X_completo</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<span class="n">teste</span> <span class="o">=</span> <span class="n">teste_completo</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">scaler_train</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="c1">#scaler_train = MinMaxScaler()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler_train</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">treino</span><span class="p">)</span>

<span class="c1">#Vamos padronizar o teste tbm</span>
<span class="n">scaler_train</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="c1">#scaler_train = MinMaxScaler()</span>
<span class="n">teste</span> <span class="o">=</span> <span class="n">scaler_train</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">teste</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

<span class="c1">#treino e validação</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Naive-Bayes">
<h2>Naive Bayes<a class="headerlink" href="#Naive-Bayes" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">balanced_accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span> <span class="c1"># 1. choose model class</span>
<span class="n">model_NB</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>                       <span class="c1"># 2. instantiate model</span>
<span class="n">model_NB</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>                <span class="c1"># 3. fit model to data</span>
<span class="n">y_predNB</span> <span class="o">=</span> <span class="n">model_NB</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>            <span class="c1"># 4. predict on new data</span>

<span class="c1"># calcula a acuracia</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Acuracia Naivy bayes: </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_predNB</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1 score Naivy bayes: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predNB</span><span class="p">,</span> <span class="n">average</span> <span class="o">=</span> <span class="s2">&quot;weighted&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Precision Naivy bayes: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predNB</span><span class="p">,</span> <span class="n">average</span> <span class="o">=</span> <span class="s2">&quot;weighted&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Acuracia Naivy bayes: 0.632
F1 score Naivy bayes: 0.655
Precision Naivy bayes: 0.656
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>

<span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model_NB</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Media Cross-val accuracy: </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cv_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variância: </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cv_scores</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.68421053 0.68421053 0.69736842 0.67105263 0.73333333 0.65333333
 0.72       0.66666667 0.62666667 0.65333333]
Media Cross-val accuracy: 0.679018
Variância: 0.000930
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>

<span class="c1">#cv = cross_validate(model_NB, X_train, y_train, return_train_score=True)</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">model_NB</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">cv</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cv</span><span class="p">[</span><span class="s1">&#39;train_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.667950495049505
0.6770484065712926
</pre></div></div>
</div>
</div>
<div class="section" id="SVM">
<h2>SVM<a class="headerlink" href="#SVM" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>

<span class="c1">#Hiper parâmetros para otimizacao</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">]</span>
<span class="n">decision_function_shape</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ovo&quot;</span><span class="p">,</span> <span class="s2">&quot;ovr&quot;</span><span class="p">]</span>
<span class="n">k_fold</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1">#GridSearch para achar a melhor combinação de valores dos hiper parâmetros.</span>
<span class="c1">#   aplicando ainda uma validação cruzada com 10 folds.</span>
<span class="n">model_svm</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">SVC</span><span class="p">(),</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">k_fold</span><span class="p">,</span>
                     <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">C</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma</span><span class="p">,</span> <span class="s2">&quot;decision_function_shape&quot;</span><span class="p">:</span> <span class="n">decision_function_shape</span><span class="p">})</span>
<span class="n">model_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>



<span class="c1">#Mensurar a qualidade do modelo ajustado</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Acurácia SVM: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1 score SVM: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span> <span class="o">=</span> <span class="s2">&quot;weighted&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Precision SVM: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span> <span class="o">=</span> <span class="s2">&quot;weighted&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Acurácia SVM: 0.574
F1 score SVM: 0.629
Precision SVM: 0.629
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#SVM</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">model_svm</span><span class="o">.</span><span class="n">best_estimator_</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cv</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cv</span><span class="p">[</span><span class="s1">&#39;train_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.6252871287128713
0.7168105813910943
</pre></div></div>
</div>
</div>
<div class="section" id="Submetendo-NB">
<h2>Submetendo NB<a class="headerlink" href="#Submetendo-NB" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_NB</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">teste</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>

<span class="n">prediction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;Game&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Id</span>
<span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
<span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;L&#39;</span><span class="p">}</span>
<span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">prediction</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Game</th>
      <th>WinOrLose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>W</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>W</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>L</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>L</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>W</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
L    130
W     35
Name: WinOrLose, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">prediction</span><span class="o">.</span><span class="n">WinOrLose</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequencia Absoluta Vitorias e derrotas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_81_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_81_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">prediction</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;NB.csv&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Score no Kaggle: 0.729</strong></p>
</div>
<div class="section" id="Submetendo-SVM">
<h2>Submetendo SVM<a class="headerlink" href="#Submetendo-SVM" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">teste</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>

<span class="n">prediction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;Game&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Id</span>
<span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
<span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;L&#39;</span><span class="p">}</span>
<span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">prediction</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Game</th>
      <th>WinOrLose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>L</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>L</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>L</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>L</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>L</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
L    136
W     29
Name: WinOrLose, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="s1">&#39;WinOrLose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">prediction</span><span class="o">.</span><span class="n">WinOrLose</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span><span class="p">],</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequencia Absoluta Vitorias e derrotas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Jupyter_NBA_Matches_Final_Games_88_0.png" src="../../_images/Jupyter_NBA_Matches_Final_Games_88_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">prediction</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;SVM.csv&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../Car_Price/Car_Price.html" class="btn btn-neutral float-left" title="Car Price" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Sepsis%20Detection/Final_Sepse.html" class="btn btn-neutral float-right" title="Sepsis Detection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Matheus de Castro Siniscarchio.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>